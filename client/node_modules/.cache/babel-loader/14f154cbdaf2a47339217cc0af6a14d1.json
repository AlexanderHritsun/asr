{"ast":null,"code":"var _jsxFileName = \"/Users/alexander_hritsun/WebstormProjects/asr/client/src/pages/Services/createServicePage.jsx\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport { useHttp } from \"../../hooks/http.hook\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { Spinner } from \"../../components/Loader\";\nimport { FormErrors } from \"../../components/FormError\";\nimport { Button, Form, Image } from \"react-bootstrap\";\n\nfunction CreateService() {\n  const {\n    loading,\n    request,\n    error\n  } = useHttp();\n  const history = useHistory();\n  const {\n    token\n  } = useContext(AuthContext);\n  const [form, setForm] = useState({\n    name: '',\n    description: '',\n    files: []\n  });\n\n  const changeHandler = event => {\n    setForm({ ...form,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const toBase64 = file => new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n\n  const fileChangeHandler = async event => {\n    const files = [...event.target.files];\n    Promise.all(files.map(file => toBase64(file))).then(values => {\n      setForm({ ...form,\n        files: [...form.files, ...values]\n      });\n    });\n  };\n\n  const removeFileHandler = idx => {\n    const copy = [...form.files];\n    copy.splice(idx, 1);\n    setForm({ ...form,\n      files: copy\n    });\n  };\n\n  const creationHandler = async () => {\n    try {\n      const data = await request('/api/services/create', 'POST', { ...form\n      }, {\n        Authorization: `Bearer ${token}`\n      });\n      history.push('/services');\n    } catch (e) {}\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FormErrors, {\n    formErrors: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 21\n    }\n  }, \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"), /*#__PURE__*/React.createElement(Form.Control, {\n    required: true,\n    size: \"lg\",\n    id: \"name\",\n    name: \"name\",\n    type: \"text\",\n    value: form.name,\n    placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\",\n    onChange: changeHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }, \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\"), /*#__PURE__*/React.createElement(Form.Control, {\n    required: true,\n    size: \"lg\",\n    id: \"description\",\n    name: \"description\",\n    type: \"text\",\n    placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\",\n    value: form.description,\n    onChange: changeHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Form.File, {\n    multiple: true,\n    id: \"custom-file-translate-scss\",\n    \"data-browse\": \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",\n    label: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0444\\u043E\\u0442\\u043E\",\n    lang: \"ru\",\n    custom: true,\n    name: \"file\",\n    accept: \"image/*\",\n    onChange: fileChangeHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }), !!form.files.length && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      marginBottom: 15\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }\n  }, form.files.map((file, i) => /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: file,\n    rounded: true,\n    style: {\n      maxWidth: 100,\n      maxHeight: 100,\n      margin: 10,\n      objectFit: 'cover'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'absolute',\n      top: 10,\n      right: 10,\n      width: 20,\n      height: 20,\n      background: 'rgba(0,0,0,0.5)',\n      borderRadius: 5,\n      fontSize: 12,\n      color: '#fff',\n      textAlign: 'center'\n    },\n    onClick: () => removeFileHandler(i),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 33\n    }\n  }, \"X\")))), /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    className: \"mr-m\",\n    type: \"button\",\n    onClick: creationHandler,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\")));\n}\n\nexport default CreateService;","map":{"version":3,"sources":["/Users/alexander_hritsun/WebstormProjects/asr/client/src/pages/Services/createServicePage.jsx"],"names":["React","useContext","useEffect","useState","useHistory","useHttp","AuthContext","Spinner","FormErrors","Button","Form","Image","CreateService","loading","request","error","history","token","form","setForm","name","description","files","changeHandler","event","target","value","toBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","fileChangeHandler","all","map","then","values","removeFileHandler","idx","copy","splice","creationHandler","data","Authorization","push","e","length","display","justifyContent","marginBottom","i","position","maxWidth","maxHeight","margin","objectFit","top","right","width","height","background","borderRadius","fontSize","color","textAlign"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from \"react\";\nimport { useHistory } from 'react-router-dom'\nimport {useHttp} from \"../../hooks/http.hook\";\nimport {AuthContext} from \"../../context/AuthContext\";\nimport {Spinner} from \"../../components/Loader\";\nimport {FormErrors} from \"../../components/FormError\";\nimport {Button, Form, Image} from \"react-bootstrap\";\n\nfunction CreateService() {\n    const {loading, request, error} = useHttp();\n    const history = useHistory();\n    const {token} = useContext(AuthContext)\n    const [form, setForm] = useState({\n        name: '', description: '', files: []\n    })\n\n    const changeHandler = event => {\n        setForm({ ...form, [event.target.name]: event.target.value })\n    }\n    const toBase64 = file => new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => resolve(reader.result);\n        reader.onerror = error => reject(error);\n    });\n    const fileChangeHandler = async (event) => {\n        const files = [...event.target.files];\n        Promise.all(files.map(file => toBase64(file))).then((values) => {\n            setForm({ ...form, files: [...form.files, ...values] });\n        });\n    }\n    const removeFileHandler = (idx) => {\n        const copy = [...form.files];\n        copy.splice(idx, 1);\n        setForm({ ...form, files: copy });\n    }\n\n    const creationHandler = async () => {\n        try {\n            const data = await request('/api/services/create', 'POST', {...form},\n                {\n                    Authorization: `Bearer ${token}`\n                }\n            )\n            history.push('/services');\n        } catch (e) {}\n    }\n\n    if (loading) {\n        return <Spinner/>\n    }\n    return (\n        <div className=\"form\">\n            <FormErrors formErrors={error} />\n            <Form>\n                <Form.Group controlId=\"name\">\n                    <Form.Label>Название</Form.Label>\n                    <Form.Control\n                        required\n                        size=\"lg\"\n                        id=\"name\"\n                        name=\"name\"\n                        type=\"text\"\n                        value={form.name}\n                        placeholder=\"Введите название\"\n                        onChange={changeHandler}\n                    />\n                </Form.Group>\n\n                <Form.Group controlId=\"description\">\n                    <Form.Label>Описание</Form.Label>\n                    <Form.Control\n                        required\n                        size=\"lg\"\n                        id=\"description\"\n                        name=\"description\"\n                        type=\"text\"\n                        placeholder=\"Введите описание\"\n                        value={form.description}\n                        onChange={changeHandler}\n                    />\n                </Form.Group>\n\n                <Form.File\n                    multiple\n                    id=\"custom-file-translate-scss\"\n                    data-browse=\"Выбрать файл\"\n                    label=\"Загрузите фото\"\n                    lang=\"ru\"\n                    custom\n                    name=\"file\"\n                    accept=\"image/*\"\n                    onChange={fileChangeHandler}\n                />\n\n                {!!form.files.length &&\n                    <div\n                        style={{\n                            display: 'flex',\n                            justifyContent: 'center',\n                            marginBottom: 15\n                        }}>\n                        {form.files.map((file, i) => (\n                            <div style={{ position: 'relative' }}>\n                                <Image src={file} rounded style={{\n                                    maxWidth: 100,\n                                    maxHeight: 100,\n                                    margin: 10,\n                                    objectFit: 'cover'\n                                }} />\n                                <div style={{ \n                                    position: 'absolute',\n                                    top: 10,\n                                    right: 10,\n                                    width: 20,\n                                    height: 20,\n                                    background: 'rgba(0,0,0,0.5)',\n                                    borderRadius: 5,\n                                    fontSize: 12,\n                                    color: '#fff',\n                                    textAlign: 'center'\n                                }}\n                                onClick={() => removeFileHandler(i)}>X</div>\n                            </div>\n                        ))}\n                    </div>}\n\n\n                <Button\n                    variant=\"secondary\"\n                    className='mr-m'\n                    type=\"button\"\n                    onClick={creationHandler}\n                    disabled={loading}\n                >\n                    Создать\n                </Button>\n            </Form>\n        </div>\n    )\n\n}\n\nexport default CreateService"]},"metadata":{},"sourceType":"module"}